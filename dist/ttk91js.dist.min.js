"use strict";var _slicedToArray=function(){function t(t,e){var r=[],n=!0,i=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){i=!0,s=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw s}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function t(e,r,n){function i(o,a){if(!r[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};e[o][0].call(c.exports,function(t){var r=e[o][1][t];return i(r?r:t)},c,c.exports,t,e,r,n)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(t,e,r){var n=function(){};n.prototype={bind:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},unbind:function(t,e){this._events=this._events||{},t in this._events!=!1&&this._events[t].splice(this._events[t].indexOf(e),1)},trigger:function(t){if(this._events=this._events||{},t in this._events!=!1)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},n.mixin=function(t){for(var e=["bind","unbind","trigger"],r=0;r<e.length;r++)t.prototype[e[r]]=n.prototype[e[r]]},"undefined"!=typeof e&&"exports"in e&&(e.exports=n)},{}],2:[function(t,e,r){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(t){if(f===setTimeout)return setTimeout(t,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(e){try{return f.call(null,t,0)}catch(e){return f.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===i||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function a(){y&&m&&(y=!1,m.length?p=m.concat(p):v=-1,p.length&&h())}function h(){if(!y){var t=s(a);y=!0;for(var e=p.length;e;){for(m=p,p=[];++v<e;)m&&m[v].run();v=-1,e=p.length}m=null,y=!1,o(t)}}function u(t,e){this.fun=t,this.array=e}function c(){}var f,l,g=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(t){f=n}try{l="function"==typeof clearTimeout?clearTimeout:i}catch(t){l=i}}();var m,p=[],y=!1,v=-1;g.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];p.push(new u(t,e)),1!==p.length||y||s(h)},u.prototype.run=function(){this.fun.apply(null,this.array)},g.title="browser",g.browser=!0,g.env={},g.argv=[],g.version="",g.versions={},g.on=c,g.addListener=c,g.once=c,g.off=c,g.removeListener=c,g.removeAllListeners=c,g.emit=c,g.binding=function(t){throw new Error("process.binding is not supported")},g.cwd=function(){return"/"},g.chdir=function(t){throw new Error("process.chdir is not supported")},g.umask=function(){return 0}},{}],3:[function(t,e,r){function n(t,e){this.name="Ttk91jsCompileException",this.message=t,this.line=e}function i(t,e,r,n,i){var s=i;return s|=t<<24,s|=e<<21,s|=r<<19,s|=n<<16}function s(t){for(var e=t.split("\n"),r=[],i={},s=[],o=[],h=0;h<e.length;h++){var u=e[h].trim(),c=u.indexOf(";");if(c!=-1&&(u=u.substring(0,c)),0!==u.length){var f=u.split(/[\s]+/);if(a.indexOf(f[0])==-1&&(s.push(f[0]),o.push(r.length),f.shift()),"DC"==f[0])o.pop(),o.push(parseInt(f[1]));else{if(3==f.length){if(","!=f[1][f[1].length-1])throw new n("syntax error",h+1);f[1]=f[1].substring(0,f[1].length-1)}if(3==f.length)if(c=f[2].indexOf("("),c!=-1){var l=f[2].indexOf(")",c);if(l==-1)throw new n("syntax error",h+1);f.push(f[2].substring(c+1,l)),f[2]=f[2].substring(0,c)}else"="==f[2][0]?f.push("R0"):"@"==f[2][0]?"R"==f[2][1]?(f.push("R"+f[2][2]),f[2]="0"):f.push("R0"):"R"==f[2][0]?(f.push(f[2]),f[2]="=0"):f.push("R0");if(a.indexOf(f[0])==-1)throw new n("unknown opcode ("+f[0]+")",h+1);f.forEach(function(t){if(2==t.length&&"R"==t[0]&&(/0-9/.test(t[1])||parseInt(t[1])>7))throw new n("invalid register ("+t+")",h+1)}),i[r.length]=h,r.push(f)}}}return{code:r,symbols:s,data:o,lineMap:i}}var o={NOP:0,STORE:1,LOAD:2,IN:3,OUT:4,ADD:17,SUB:18,MUL:19,DIV:20,MOD:21,AND:22,OR:23,XOR:24,SHL:25,SHR:26,NOT:27,SHRA:28,COMP:31,JUMP:32,JNEG:33,JZER:34,JPOS:35,JNNEG:36,JNZER:37,JNPOS:38,JLES:39,JEQU:40,JGRE:41,JNLES:42,JNEQU:43,JNGRE:44,CALL:49,EXIT:50,PUSH:51,POP:52,PUSHR:53,POPR:54,SVC:112},a=Object.keys(o),h={CRT:0},u={HALT:11},c={IMMEDIATE:0,DIRECT:1,INDIRECT:2},f=6;n.prototype.toString=function(){return this.name+": "+this.message};var l=function(t){function e(t){for(var e=0;e<l.symbols.length;e++)if(l.symbols[e]==t)return l.code.length+e;throw new n("unknown symbol ("+t+")")}function r(t){return"SP"==t||2==t.length&&"R"==t[0]}function a(t){return"SP"==t?f:parseInt(t[1])}var l=s(t),g=[],m=!0,p=!1,y=void 0;try{for(var v,d=l.code[Symbol.iterator]();!(m=(v=d.next()).done);m=!0){var R=v.value;r(R[1])?R[1]=a(R[1]):R[1]=e(R[1]);var E=o[R[0]],b=R[1],T=0,w=c.DIRECT,S=0;if(R.length>2){if("="==R[2][0]){w=c.IMMEDIATE;var O=R[2].substring(1);if(/^[0-9]+$/i.test(O))S=parseInt(O);else switch(O){case"CRT":S=h.CRT;break;case"HALT":S=u.HALT}}else"@"==R[2][0]?(w=c.INDIRECT,S=parseInt(R[2].substring(1))):S=/^[a-z]+$/i.test(R[2])?e(R[2]):parseInt(R[2]);T=a(R[3])}E>=o.JUMP&&E<=o.JNGRE&&(S=b,b=0,w=0);var J=i(E,b,w,T,S);g.push(J)}}catch(t){p=!0,y=t}finally{try{!m&&d.return&&d.return()}finally{if(p)throw y}}return{lines:l.code,code:g,symbols:l.symbols,data:l.data,lineMap:l.lineMap}};e.exports=l},{}],4:[function(t,e,r){var n=t("./ttk91js.compile.js"),i=t("./ttk91js.machine.js"),s={compile:n,createMachine:function(t){return new i(t)}};"undefined"==typeof window?e.exports=s:window.ttk91js=s},{"./ttk91js.compile.js":3,"./ttk91js.machine.js":5}],5:[function(t,e,r){(function(r){function n(t){return[(t&255<<24)>>24,(t&7<<21)>>21,(t&3<<19)>>19,(t&7<<16)>>16,65535&t]}function i(t){this.settings=t,this.memory=new Uint32Array(t.memory),this.reg=new Uint32Array(9),this.stdout={write:function(t){r.stdout.write(t+"\n")}},this.lastPosition=0,this.reset()}var s=t("microevent"),o={NOP:0,STORE:1,LOAD:2,IN:3,OUT:4,ADD:17,SUB:18,MUL:19,DIV:20,MOD:21,AND:22,OR:23,XOR:24,SHL:25,SHR:26,NOT:27,SHRA:28,COMP:31,JUMP:32,JNEG:33,JZER:34,JPOS:35,JNNEG:36,JNZER:37,JNPOS:38,JLES:39,JEQU:40,JGRE:41,JNLES:42,JNEQU:43,JNGRE:44,CALL:49,EXIT:50,PUSH:51,POP:52,PUSHR:53,POPR:54,SVC:112},a={CRT:0},h={HALT:11},u=4,c=2,f=1,l=8;i.prototype={_getValue:function(t,e,r){var n=0;return n=0===e?r:this.reg[e]+r,t>0&&(n=this._getValue(--t,e,this.memory[r])),n},load:function(t){for(var e=0;e<t.code.length;e++)this.memory[e]=t.code[e];for(var r=0;r<t.symbols.length;r++)this.memory[e+r]=t.data[r];this.data=t},getRegisters:function(){return this.reg},getMemory:function(){return this.memory},getRealLine:function(){return this.data.lineMap[this.lastPosition]},stop:function(){this.ok=!1},setStdout:function(t){this.stdout=t},reset:function(){this.ok=!0,this.SR=0,this.reg.fill(0),this.memory.fill(0)},run:function(t){t=t||-1;for(var e=0;this.isRunning()&&(this.runWord(),e++,!(t>0&&e>=t)););},isRunning:function(){return this.ok&&this.reg[l]<this.memory.length},runWord:function(t){t=t||1;for(var e=0;e<t;e++)this._runWord()},_runWord:function(){var t=n(this.memory[this.reg[l]]),e=_slicedToArray(t,5),r=e[0],i=e[1],s=e[2],g=e[3],m=e[4],p=this._getValue(s,g,m);this.lastPosition=this.reg[l],this.reg[l]++;var y=void 0;switch(r){case o.STORE:y=this.memory[m],this.memory[m]=this.reg[i],this.settings.triggerMemoryChange&&y!=this.memory[m]&&this.trigger("memory-change",m,y,this.memory[m]);break;case o.LOAD:y=this.reg[i],this.reg[i]=p,this.settings.triggerRegisterChange&&y!=this.reg[i]&&this.trigger("register-change",i,y,this.reg[i]);break;case o.OUT:switch(m){case a.CRT:this.stdout.write(this.reg[i])}break;case o.ADD:this.reg[i]+=p;break;case o.SUB:this.reg[i]-=p;break;case o.DIV:this.reg[i]=Math.floor(this.reg[i]/p);break;case o.MUL:this.reg[i]*=p;break;case o.SVC:switch(m){case h.HALT:this.ok=!1,this.trigger("halt")}break;case o.COMP:this.SR=0,this.reg[i]==p&&(this.SR|=c),this.reg[i]>p&&(this.SR|=f),this.reg[i]<p&&(this.SR|=u);break;case o.JUMP:this.reg[l]=this.memory[m];break;case o.JNEG:break;case o.JZER:break;case o.JPOS:break;case o.JNNEG:break;case o.JNZER:break;case o.JNPOS:break;case o.JLES:break;case o.JEQU:this.SR&c&&(this.reg[l]=this.memory[m]);break;case o.JGRE:break;case o.JNLES:break;case o.JNEQU:this.SR&c||(this.reg[l]=this.memory[m]);break;case o.JNGRE:}}},s.mixin(i),e.exports=i}).call(this,t("_process"))},{_process:2,microevent:1}]},{},[4]);