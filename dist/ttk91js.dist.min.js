"use strict";!function t(e,r,i){function n(o,a){if(!r[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};e[o][0].call(c.exports,function(t){var r=e[o][1][t];return n(r?r:t)},c,c.exports,t,e,r,i)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(t,e,r){var i=function(t){function e(t,e,r,i,n){var s=n;return s|=t<<24,s|=e<<21,s|=r<<19,s|=i<<16}function r(t){for(var e=t.split("\n"),r=[],i={},s=[],o=[],a=0;a<e.length;a++){var h=e[a].trim(),u=h.indexOf(";");if(u!=-1&&(h=h.substring(0,u)),0!==h.length){var c=h.split(/[\s]+/);if(n.indexOf(c[0])==-1&&(s.push(c[0]),o.push(r.length),c.shift()),"DC"==c[0])o.pop(),o.push(parseInt(c[1]));else{if(3==c.length&&(","!=c[1][c[1].length-1]||(c[1]=c[1].substring(0,c[1].length-1))),3==c.length)if(u=c[2].indexOf("("),u!=-1){var f=c[2].indexOf(")",u);f==-1||(c.push(c[2].substring(u+1,f)),c[2]=c[2].substring(0,u))}else"="==c[2][0]?c.push("R0"):"@"==c[2][0]?"R"==c[2][1]?(c.push("R"+c[2][2]),c[2]="0"):c.push("R0"):"R"==c[2][0]?(c.push(c[2]),c[2]="=0"):c.push("R0");i[r.length]=a,r.push(c)}}}return{code:r,symbols:s,data:o,lineMap:i}}var i={NOP:0,STORE:1,LOAD:2,IN:3,OUT:4,ADD:17,SUB:18,MUL:19,DIV:20,MOD:21,AND:22,OR:23,XOR:24,SHL:25,SHR:26,NOT:27,SHRA:28,COMP:31,JUMP:32,JNEG:33,JZER:34,JPOS:35,JNNEG:36,JNZER:37,JNPOS:38,JLES:39,JEQU:40,JGRE:41,JNLES:42,JNEQU:43,JNGRE:44,CALL:49,EXIT:50,PUSH:51,POP:52,PUSHR:53,POPR:54,SVC:112},n=Object.keys(i),s={CRT:0},o={HALT:11},a={IMMEDIATE:0,DIRECT:1,INDIRECT:2},h=6;t.compile=function(t){function n(t){for(var e=0;e<f.symbols.length;e++)if(f.symbols[e]==t)return f.code.length+e}function u(t){return"SP"==t||2==t.length&&"R"==t[0]}function c(t){return"SP"==t?h:parseInt(t[1])}var f=r(t),l=[],g=!0,p=!1,v=void 0;try{for(var y,R=f.code[Symbol.iterator]();!(g=(y=R.next()).done);g=!0){var m=y.value;u(m[1])?m[1]=c(m[1]):m[1]=n(m[1]);var d=i[m[0]],E=m[1],O=0,P=a.DIRECT,S=0;if(m.length>2){if("="==m[2][0]){P=a.IMMEDIATE;var b=m[2].substring(1);if(/^[0-9]+$/i.test(b))S=parseInt(b);else switch(b){case"CRT":S=s.CRT;break;case"HALT":S=o.HALT}}else"@"==m[2][0]?(P=a.INDIRECT,S=parseInt(m[2].substring(1))):S=/^[a-z]+$/i.test(m[2])?n(m[2]):parseInt(m[2]);O=c(m[3])}d>=i.JUMP&&d<=i.JNGRE&&(S=E,E=0,P=0);var J=e(d,E,P,O,S);l.push(J)}}catch(t){p=!0,v=t}finally{try{!g&&R.return&&R.return()}finally{if(p)throw v}}return{lines:f.code,code:l,symbols:f.symbols,data:f.data,lineMap:f.lineMap}};return t}(i||{});"undefined"!=typeof e&&"exports"in e&&(e.exports=i)},{}]},{},[1]);var _slicedToArray=function(){function t(t,e){var r=[],i=!0,n=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(r.push(o.value),!e||r.length!==e);i=!0);}catch(t){n=!0,s=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw s}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function t(e,r,i){function n(o,a){if(!r[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};e[o][0].call(c.exports,function(t){var r=e[o][1][t];return n(r?r:t)},c,c.exports,t,e,r,i)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(t,e,r){var i=function(){};i.prototype={bind:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},unbind:function(t,e){this._events=this._events||{},t in this._events!=!1&&this._events[t].splice(this._events[t].indexOf(e),1)},trigger:function(t){if(this._events=this._events||{},t in this._events!=!1)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},i.mixin=function(t){for(var e=["bind","unbind","trigger"],r=0;r<e.length;r++)t.prototype[e[r]]=i.prototype[e[r]]},"undefined"!=typeof e&&"exports"in e&&(e.exports=i)},{}],2:[function(t,e,r){var i=function(e){function r(t){return[(t&255<<24)>>24,(t&7<<21)>>21,(t&3<<19)>>19,(t&7<<16)>>16,65535&t]}function i(t){this.settings=t,this.memory=new Uint32Array(t.memory),this.stdout=function(t){},this.lastPosition=0,this.reset()}var n=t("microevent"),s={NOP:0,STORE:1,LOAD:2,IN:3,OUT:4,ADD:17,SUB:18,MUL:19,DIV:20,MOD:21,AND:22,OR:23,XOR:24,SHL:25,SHR:26,NOT:27,SHRA:28,COMP:31,JUMP:32,JNEG:33,JZER:34,JPOS:35,JNNEG:36,JNZER:37,JNPOS:38,JLES:39,JEQU:40,JGRE:41,JNLES:42,JNEQU:43,JNGRE:44,CALL:49,EXIT:50,PUSH:51,POP:52,PUSHR:53,POPR:54,SVC:112},o={CRT:0},a={HALT:11},h=4,u=2,c=1,f=6,l=7;return i.prototype={_getValue:function(t,e,r){var i=0;return i=0===e?r:this.reg[e]+r,t>0&&(i=this._getValue(--t,e,this.memory[r])),i},load:function(t){for(var e=0;e<t.code.length;e++)this.memory[e]=t.code[e];for(var r=0;r<t.symbols.length;r++)this.memory[e+r]=t.data[r];this.data=t},getRegister:function(){return{0:this.reg[0],1:this.reg[1],2:this.reg[2],3:this.reg[3],4:this.reg[4],5:this.reg[5],SP:this.reg[f],FP:this.reg[l],PC:this.reg.PC}},getMemory:function(){return this.memory},getRealLine:function(){return this.data.lineMap[this.lastPosition]},stop:function(){this.ok=!1},setStdout:function(t){this.stdout=t},reset:function(){this.ok=!0,this.SR=0,this.reg={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,FP:0,PC:0},this.memory.fill(0)},run:function(){for(var t=0;this.isRunning()&&t<100;)this.runWord(),t++},isRunning:function(){return this.ok&&this.reg.PC<this.memory.length},runWord:function(t){t=t||1;for(var e=0;e<t;e++)this._runWord()},_runWord:function(){var t=r(this.memory[this.reg.PC]),e=_slicedToArray(t,5),i=e[0],n=e[1],f=e[2],l=e[3],g=e[4],p=this._getValue(f,l,g);switch(this.lastPosition=this.reg.PC,this.reg.PC++,i){case s.STORE:var v=this.memory[g];this.memory[g]=this.reg[n],this.settings.triggerMemoryChange&&v!=this.memory[g]&&this.trigger("memory-change",g,v,this.memory[g]);break;case s.LOAD:this.reg[n]=p;break;case s.OUT:switch(g){case o.CRT:this.stdout(this.reg[n])}break;case s.ADD:this.reg[n]+=p;break;case s.SUB:this.reg[n]-=p;break;case s.DIV:this.reg[n]=Math.floor(this.reg[n]/p);break;case s.MUL:this.reg[n]*=p;break;case s.SVC:switch(g){case a.HALT:this.ok=!1}break;case s.COMP:this.SR=0,this.reg[n]==p&&(this.SR|=u),this.reg[n]>p&&(this.SR|=c),this.reg[n]<p&&(this.SR|=h);break;case s.JUMP:this.reg.PC=this.memory[g];break;case s.JNEG:break;case s.JZER:break;case s.JPOS:break;case s.JNNEG:break;case s.JNZER:break;case s.JNPOS:break;case s.JLES:break;case s.JEQU:this.SR&u&&(this.reg.PC=this.memory[g]);break;case s.JGRE:break;case s.JNLES:break;case s.JNEQU:this.SR&u||(this.reg.PC=this.memory[g]);break;case s.JNGRE:}}},n.mixin(i),e.Machine=i,e}(i||{});"undefined"!=typeof e&&"exports"in e&&(e.exports=i)},{microevent:1}]},{},[2]);