"use strict";var _slicedToArray=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(n=(s=u.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function e(t,r,n){function i(s,u){if(!r[s]){if(!t[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(o)return o(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var f=r[s]={exports:{}};t[s][0].call(f.exports,function(e){var r=t[s][1][e];return i(r?r:e)},f,f.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){var n=function(){};n.prototype={bind:function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},unbind:function(e,t){this._events=this._events||{},e in this._events!=!1&&this._events[e].splice(this._events[e].indexOf(t),1)},trigger:function(e){if(this._events=this._events||{},e in this._events!=!1)for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}},n.mixin=function(e){for(var t=["bind","unbind","trigger"],r=0;r<t.length;r++)e.prototype[t[r]]=n.prototype[t[r]]},"undefined"!=typeof t&&"exports"in t&&(t.exports=n)},{}],2:[function(e,t,r){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function s(e){if(p===clearTimeout)return clearTimeout(e);if((p===i||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{return p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}function u(){m&&g&&(m=!1,g.length?y=g.concat(y):d=-1,y.length&&c())}function c(){if(!m){var e=o(u);m=!0;for(var t=y.length;t;){for(g=y,y=[];++d<t;)g&&g[d].run();d=-1,t=y.length}g=null,m=!1,s(e)}}function a(e,t){this.fun=e,this.array=t}function f(){}var l,p,h=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{p="function"==typeof clearTimeout?clearTimeout:i}catch(e){p=i}}();var g,y=[],m=!1,d=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];y.push(new a(e,t)),1!==y.length||m||o(c)},a.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=f,h.addListener=f,h.once=f,h.off=f,h.removeListener=f,h.removeAllListeners=f,h.emit=f,h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],3:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],4:[function(e,t,r){t.exports=function(e){return e&&"object"===("undefined"==typeof e?"undefined":_typeof(e))&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],5:[function(e,t,r){(function(t,n){function i(e,t){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),y(t)?n.showHidden=t:t&&r._extend(n,t),E(n.showHidden)&&(n.showHidden=!1),E(n.depth)&&(n.depth=2),E(n.colors)&&(n.colors=!1),E(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),c(n,e,n.depth)}function o(e,t){var r=i.styles[t];return r?"["+i.colors[r][0]+"m"+e+"["+i.colors[r][1]+"m":e}function s(e,t){return e}function u(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function c(e,t,n){if(e.customInspect&&t&&S(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return v(i)||(i=c(e,i,n)),i}var o=a(e,t);if(o)return o;var s=Object.keys(t),y=u(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),R(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(t);if(0===s.length){if(S(t)){var m=t.name?": "+t.name:"";return e.stylize("[Function"+m+"]","special")}if(w(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(k(t))return e.stylize(Date.prototype.toString.call(t),"date");if(R(t))return f(t)}var d="",b=!1,O=["{","}"];if(g(t)&&(b=!0,O=["[","]"]),S(t)){var E=t.name?": "+t.name:"";d=" [Function"+E+"]"}if(w(t)&&(d=" "+RegExp.prototype.toString.call(t)),k(t)&&(d=" "+Date.prototype.toUTCString.call(t)),R(t)&&(d=" "+f(t)),0===s.length&&(!b||0==t.length))return O[0]+d+O[1];if(n<0)return w(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var j;return j=b?l(e,t,n,y,s):s.map(function(r){return p(e,t,n,y,r,b)}),e.seen.pop(),h(j,d,O)}function a(e,t){if(E(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return b(t)?e.stylize(""+t,"number"):y(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,r,n,i){for(var o=[],s=0,u=t.length;s<u;++s)N(t,String(s))?o.push(p(e,t,r,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(e,t,r,n,i,!0))}),o}function p(e,t,r,n,i,o){var s,u,a;if(a=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},a.get?u=a.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):a.set&&(u=e.stylize("[Setter]","special")),N(n,i)||(s="["+i+"]"),u||(e.seen.indexOf(a.value)<0?(u=m(r)?c(e,a.value,null):c(e,a.value,r-1),u.indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special")),E(s)){if(o&&i.match(/^\d+$/))return u;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function h(e,t,r){var n=0,i=e.reduce(function(e,t){return n++,t.indexOf("\n")>=0&&n++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function g(e){return Array.isArray(e)}function y(e){return"boolean"==typeof e}function m(e){return null===e}function d(e){return null==e}function b(e){return"number"==typeof e}function v(e){return"string"==typeof e}function O(e){return"symbol"===("undefined"==typeof e?"undefined":_typeof(e))}function E(e){return void 0===e}function w(e){return j(e)&&"[object RegExp]"===x(e)}function j(e){return"object"===("undefined"==typeof e?"undefined":_typeof(e))&&null!==e}function k(e){return j(e)&&"[object Date]"===x(e)}function R(e){return j(e)&&("[object Error]"===x(e)||e instanceof Error)}function S(e){return"function"==typeof e}function T(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===("undefined"==typeof e?"undefined":_typeof(e))||"undefined"==typeof e}function x(e){return Object.prototype.toString.call(e)}function D(e){return e<10?"0"+e.toString(10):e.toString(10)}function P(){var e=new Date,t=[D(e.getHours()),D(e.getMinutes()),D(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}function N(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var A=/%[sdj%]/g;r.format=function(e){if(!v(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(i(arguments[r]));return t.join(" ")}for(var r=1,n=arguments,o=n.length,s=String(e).replace(A,function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),u=n[r];r<o;u=n[++r])s+=m(u)||!j(u)?" "+u:" "+i(u);return s},r.deprecate=function(e,i){function o(){if(!s){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),s=!0}return e.apply(this,arguments)}if(E(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(t.noDeprecation===!0)return e;var s=!1;return o};var I,_={};r.debuglog=function(e){if(E(I)&&(I=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!_[e])if(new RegExp("\\b"+e+"\\b","i").test(I)){var n=t.pid;_[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else _[e]=function(){};return _[e]},r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=g,r.isBoolean=y,r.isNull=m,r.isNullOrUndefined=d,r.isNumber=b,r.isString=v,r.isSymbol=O,r.isUndefined=E,r.isRegExp=w,r.isObject=j,r.isDate=k,r.isError=R,r.isFunction=S,r.isPrimitive=T,r.isBuffer=e("./support/isBuffer");var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];r.log=function(){console.log("%s - %s",P(),r.format.apply(r,arguments))},r.inherits=e("inherits"),r._extend=function(e,t){if(!t||!j(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":4,_process:2,inherits:3}],6:[function(e,t,r){function n(e){return[(e&255<<24)>>24,(e&7<<21)>>21,(e&3<<19)>>19,(e&7<<16)>>16,65535&e]}t.exports={splitWord:n,OP:Object.freeze({NOP:0,STORE:1,LOAD:2,IN:3,OUT:4,ADD:17,SUB:18,MUL:19,DIV:20,MOD:21,AND:22,OR:23,XOR:24,SHL:25,SHR:26,NOT:27,SHRA:28,COMP:31,JUMP:32,JNEG:33,JZER:34,JPOS:35,JNNEG:36,JNZER:37,JNPOS:38,JLES:39,JEQU:40,JGRE:41,JNLES:42,JNEQU:43,JNGRE:44,CALL:49,EXIT:50,PUSH:51,POP:52,PUSHR:53,POPR:54,SVC:112}),MODE:Object.freeze({IMMEDIATE:0,DIRECT:1,INDIRECT:2}),SR_BITS:Object.freeze({G:1,E:2,L:4,OVERFLOW:8,DIVIDE_BY_ZERO:16,UNKNOWN_INSTRUCTION:32,FORBIDDED_MEMORY_ADRESS:64,DEVICE_INTERRUPT:128,SVC:256,PRIVILEGED:512,INTERRUPTS_DISABLED:1024})}},{}],7:[function(e,t,r){function n(e,t,r,n,i){var o=i;return o|=e<<24,o|=t<<21,o|=r<<19,o|=n<<16}function i(e){return e=f.OP[e],e===f.OP.NOP?0:e==f.OP.NOT?1:e>=f.OP.JUMP&&e<=f.OP.JNGRE?1:2}function o(e){return 2==e.length&&(e=e.toUpperCase(),"SP"==e||"FP"==e||"R"==e[0]&&/[0-9]/.test(e[1]))}function s(e){return"="!=e[0]&&"@"!=e[0]||(e=e.substring(1)),/^[a-z][0-9a-z]*$/i.test(e)}function u(e){return"="!=e[0]&&"@"!=e[0]||(e=e.substring(1)),/^[0-9]+$/.test(e)}function c(e){return s(e)||o(e)||u(e)}function a(e){function t(e){return"="!=e[0]&&"@"!=e[0]||(e=e.substring(1)),e}function r(e){var t=!0,r=!1,n=void 0;try{for(var i,o=a[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=i.value;if(s.name==e)return!0}}catch(e){r=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw n}}switch(e.toUpperCase()){case"CRT":case"HALT":return!0}return!1}for(var n=e.split("\n"),o=[],u=[],a=[],f=[],h=0,g=function(e){var t=n[e].trim(),r=t.indexOf(";");if(r!=-1&&(t=t.substring(0,r)),0===t.length)return"continue";t=t.replace(/\s+/g," "),r=t.indexOf(" ");var s=null;if(s=r==-1?[t.trim()]:[t.substring(0,r),t.substring(r+1)],p.indexOf(s[0].toUpperCase())==-1){if(1==s.length)throw new l("unknown opcode ("+s[0]+")",e);a.push({name:s[0],value:o.length,type:"absolute",size:1}),r=s[1].indexOf(" "),r!=-1&&(s=[s[1].substring(0,r),s[1].substring(r+1)])}s[0]=s[0].toUpperCase();var g=void 0,y=void 0;switch(s[0]){case"EQU":g=parseInt(s[1]),y=a.pop().name,a.push({name:y,value:g,type:"absolute",size:0});break;case"DC":g=parseInt(s[1]),y=a.pop().name,a.push({name:y,value:h,type:"relative",size:1}),f.push({value:g,size:1}),h+=1;break;case"DS":var m=parseInt(s[1]);y=a.pop().name,a.push({name:y,value:h,type:"relative",size:m}),f.push({value:0,size:m}),h+=m;break;default:var d=s.shift(),b=[];if(s.length>0&&(b=s.join("").split(",").map(function(e){return e.trim()})),p.indexOf(d)==-1)throw new l("unknown opcode ("+d+")",e);if(2==b.length)if(r=b[1].indexOf("("),r!=-1){var v=b[1].indexOf(")",r);if(v==-1)throw new l("syntax error",e);b.push(b[1].substring(r+1,v)),b[1]=b[1].substring(0,r)}else b[1].length>0&&("="==b[1][0]?b.push("R0"):"@"==b[1][0]?"R"==b[1][1].toUpperCase()?(b.push("R"+b[1][2]),b[1]="0"):b.push("R0"):"R"==b[1][0].toUpperCase()?(b.push(b[1]),b[1]="=0"):b.push("R0"));if(b.forEach(function(r){if(!c(r))throw new l("syntax error ("+t+")",e)}),b.forEach(function(t){if(2==t.length&&"R"==t[0].toUpperCase()&&(/0-9/.test(t[1])||parseInt(t[1])>7))throw new l("invalid register ("+t+")",e)}),i(d)!=b.length-1)throw new l("wrong argcount ("+d+")",e);u.push(e),o.push({line:e,code:[d].concat(b)})}},y=0;y<n.length;y++){g(y)}var m=!0,d=!1,b=void 0;try{for(var v,O=o[Symbol.iterator]();!(m=(v=O.next()).done);m=!0){var E=v.value;if(2==E.code.length&&s(E.code[1])){var w=t(E.code[1]);if(!r(w))throw new l("unknown symbol ("+w+")",E.line)}else if(4==E.code.length&&s(E.code[2])){var j=t(E.code[2]);if(!r(j))throw new l("unknown symbol ("+j+")",E.line)}}}catch(e){d=!0,b=e}finally{try{!m&&O.return&&O.return()}finally{if(d)throw b}}return{code:o,symbols:a,data:f,sourceMap:u}}var f=e("./ttk91js.common.js"),l=e("./ttk91js.exceptions.js").Ttk91jsCompileException,p=(e("./ttk91js.debugger.js"),Object.keys(f.OP)),h={CRT:0},g={HALT:11},y=f.MODE,m=6,d=function(e){function t(e){for(var t=0;t<i.symbols.length;t++)if(i.symbols[t].name==e)return i.symbols[t].value}function r(e){return"SP"==e?m:parseInt(e[1])}for(var i=a(e),s=[],u=0;u<i.symbols.length;u++)"relative"==i.symbols[u].type&&(i.symbols[u].value+=i.code.length),delete i.symbols[u].type;var c=!0,l=!1,p=void 0;try{for(var d,b=i.code[Symbol.iterator]();!(c=(d=b.next()).done);c=!0){var v=d.value,O=v.code,E=f.OP[O[0]],w=0,j=0,k=y.DIRECT,R=0;if(O.length>1&&(w=o(O[1])?r(O[1]):t(O[1])),O.length>2)if(j=r(O[3]),0!==j&&(k=y.IMMEDIATE),E==f.OP.STORE&&(k=y.IMMEDIATE),"="==O[2][0]){k=y.IMMEDIATE;var S=O[2].substring(1);if(/^[0-9]+$/i.test(S))R=parseInt(S);else switch(S){case"CRT":R=h.CRT;break;case"HALT":R=g.HALT;break;default:R=t(S)}}else if("@"==O[2][0]){k=y.INDIRECT;var T=O[2].substring(1);R=t(T)}else R=/^[a-z]+$/i.test(O[2])?t(O[2]):parseInt(O[2]);E>=f.OP.JUMP&&E<=f.OP.JNGRE&&(R=w,w=0,k=0);var x=n(E,w,k,j,R);s.push(x)}}catch(e){l=!0,p=e}finally{try{!c&&b.return&&b.return()}finally{if(l)throw p}}return{code:s,data:i.data,debugData:{symbols:Object.freeze(i.symbols),sourceMap:Object.freeze(i.sourceMap)}}};t.exports=d},{"./ttk91js.common.js":6,"./ttk91js.debugger.js":8,"./ttk91js.exceptions.js":9}],8:[function(e,t,r){function n(e){this.PC=0,this.IR=0,this.symbols=Object.freeze(e.symbols),this.sourceMap=Object.freeze(e.sourceMap)}var i=(e("./ttk91js.exceptions.js").Ttk91jsCompileException,e("./ttk91js.exceptions.js").Ttk91jsRuntimeException);n.prototype={cycle:function(e,t){this.PC=e,this.IR=t,console.log("#"+e)},cycleEnd:function(e){this.PC=e},getCurrentLineNumber:function(){return this.getLineNumber(this.PC)},getLineNumber:function(e){return e instanceof i?this.getLineNumber(this.PC):e<0||e>=this.sourceMap.length?null:this.sourceMap[e]}},t.exports=n},{"./ttk91js.exceptions.js":9}],9:[function(e,t,r){function n(e){this.name="Ttk91jsRuntimeException",this.message=e}function i(e,t){this.name="Ttk91jsCompileException",this.message=e,this.line=t}n.prototype.toString=function(){return this.name+": "+this.message},i.prototype.toString=function(){return this.name+": "+this.message},t.exports={Ttk91jsCompileException:i,Ttk91jsRuntimeException:n}},{}],10:[function(e,t,r){function n(e){var t=o.splitWord(e),r=_slicedToArray(t,5),n=r[0],s=r[1],u=r[2],a=r[3],f=r[4];if(0===n)return"NOP";var l="";switch(u){case o.MODE.IMMEDIATE:l="=";break;case o.MODE.INDIRECT:l="@"}if(n>=o.OP.JUMP&&n<=o.OP.JNGRE)return i.format("%s %d",c[n],f);var p="R"+s;return 6==s?p="SP":7==s&&(p="FP"),i.format("%s %s, %s%s(R%s)",c[n],p,l,f,a)}var i=e("util"),o=e("./ttk91js.common.js"),s=e("./ttk91js.compile.js"),u=e("./ttk91js.machine.js"),c=(Object.keys(o.OP),{});for(var a in o.OP)c[o.OP[a]]=a;var f={word:function(e){var t=("0".repeat(32)+(e>>>0).toString(2)).slice(-32);console.log(t.substr(0,8)+" "+t.substr(8,3)+" "+t.substr(11,2)+" "+t.substr(13,3)+" "+t.substr(16))},bin:function(e){console.log(("0".repeat(32)+(e>>>0).toString(2)).slice(-32))}},l={wordToSymbolic:n,compile:s,createMachine:function(e){return new u(e)},debug:f};"undefined"==typeof window?t.exports=l:window.ttk91js=l},{"./ttk91js.common.js":6,"./ttk91js.compile.js":7,"./ttk91js.machine.js":11,util:5}],11:[function(e,t,r){(function(r){function n(e){this.settings=e,this.memory=Object.freeze(new u(e.memory||512)),this.reg=new Uint32Array(9),this.stdout={write:function(e){r.stdout.write(e+"\n")}},this.reset()}var i=e("microevent"),o=e("./ttk91js.common.js"),s=e("./ttk91js.exceptions.js").Ttk91jsRuntimeException,u=e("./ttk91js.memory.js"),c=e("./ttk91js.debugger.js"),a={CRT:0},f={HALT:11},l=o.OP,p=o.SR_BITS,h=8;n.prototype={getDebugger:function(){return this.debugger},reset:function(){this.ok=!0,this.SR=0,this.reg.fill(0),this.memory.reset(),this.debugger=null},load:function(e){for(var t=0;t<e.code.length;t++)this.memory.setAt(t,e.code[t]);for(var r=0,n=0;n<e.data.length;n++)this.memory.setAt(t+r,e.data[n].value),r+=e.data[n].size;this.debugger=new c(e.debugData)},getRegisters:function(){return this.reg},getMemory:function(){return this.memory},stop:function(){this.ok=!1},setStdout:function(e){this.stdout=e},run:function(e){e=e||-1;for(var t=0;this.isRunning()&&(this.runWord(),t++,!(e>0&&t>=e)););},isRunning:function(){return this.ok&&this.reg[h]<this.memory.size()},runWord:function(e){e=e||1;for(var t=0;t<e;t++)this._runWord()},_getValue:function(e,t,r){var n=0;if(n=0===t?r:this.reg[t]+r,e>=3)throw new s("Invalid memory access mode");return e>0&&(n=this._getValue(--e,t,this.memory.getAt(r))),n},_runWord:function(){var e=this.memory.getAt(this.reg[h]);this.debugger.cycle(this.reg[h],e);var t=o.splitWord(e),r=_slicedToArray(t,5),n=r[0],i=r[1],u=r[2],c=r[3],g=r[4],y=this._getValue(u,c,g);switch(this.reg[h]++,n){case l.NOP:break;case l.STORE:this.settings.triggerMemoryWrite&&this.trigger("memory-write",y,this.memory.getAt(y),this.reg[i]),this.memory.setAt(y,this.reg[i]);break;case l.LOAD:this.settings.triggerRegisterWrite&&this.trigger("register-write",i,this.reg[i],y),this.reg[i]=y;break;case l.OUT:switch(g){case a.CRT:this.stdout.write(this.reg[i])}break;case l.ADD:this.reg[i]+=y;break;case l.SUB:this.reg[i]-=y;break;case l.DIV:this.reg[i]=Math.floor(this.reg[i]/y);break;case l.MUL:this.reg[i]*=y;break;case l.MOD:this.reg[i]=this.reg[i]%y;break;case l.AND:this.reg[i]=this.reg[i]&y;break;case l.OR:this.reg[i]=this.reg[i]|y;break;case l.XOR:this.reg[i]=this.reg[i]^y;break;case l.SHL:this.reg[i]=this.reg[i]<<y;break;case l.SHR:this.reg[i]=this.reg[i]>>y;break;case l.SHRA:this.reg[i]=this.reg[i]>>>y;break;case l.NOT:this.reg[i]=~this.reg[i];break;case l.SVC:switch(g){case f.HALT:this.ok=!1,this.trigger("halt")}break;case l.COMP:this.SR=0,this.reg[i]==y&&(this.SR|=p.E),this.reg[i]>y&&(this.SR|=p.G),this.reg[i]<y&&(this.SR|=p.L);break;case l.JUMP:this.reg[h]=g;break;case l.JNEG:break;case l.JZER:break;case l.JPOS:break;case l.JNNEG:break;case l.JNZER:break;case l.JNPOS:break;case l.JLES:break;case l.JEQU:this.SR&p.E&&(this.reg[h]=this.memory.getAt(g));break;case l.JGRE:break;case l.JNLES:break;case l.JNEQU:this.SR&p.E||(this.reg[h]=this.memory.getAt(g));break;case l.JNGRE:break;default:throw new s("unknown opcode ("+n+")")}this.debugger.cycleEnd(this.reg[h]),this.settings.triggerRegisterWrite&&this.trigger("register-write",h,this.debugger.PC,this.reg[h])}},i.mixin(n),t.exports=n}).call(this,e("_process"))},{"./ttk91js.common.js":6,"./ttk91js.debugger.js":8,"./ttk91js.exceptions.js":9,"./ttk91js.memory.js":12,_process:2,microevent:1}],12:[function(e,t,r){function n(e){this.memory=new Uint32Array(e)}var i=e("./ttk91js.exceptions.js").Ttk91jsRuntimeException;n.prototype={setAt:function(e,t){if(e<0||e>=this.memory.length)throw new i("trying to access outside of program memory ("+e+")");this.memory[e]=t},getAt:function(e){if(e<0||e>=this.memory.length)throw new i("trying to access outside of program memory ("+e+")");return this.memory[e]},getAll:function(){return this.memory},reset:function(){this.memory.fill(0)},size:function(){return this.memory.length}},t.exports=n},{"./ttk91js.exceptions.js":9}]},{},[10]);