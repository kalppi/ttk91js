"use strict";var _slicedToArray=function(){function t(t,e){var r=[],i=!0,s=!1,n=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(r.push(o.value),!e||r.length!==e);i=!0);}catch(t){s=!0,n=t}finally{try{!i&&a.return&&a.return()}finally{if(s)throw n}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function t(e,r,i){function s(o,a){if(!r[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(n)return n(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};e[o][0].call(c.exports,function(t){var r=e[o][1][t];return s(r?r:t)},c,c.exports,t,e,r,i)}return r[o].exports}for(var n="function"==typeof require&&require,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(t,e,r){var i=function(){};i.prototype={bind:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},unbind:function(t,e){this._events=this._events||{},t in this._events!=!1&&this._events[t].splice(this._events[t].indexOf(e),1)},trigger:function(t){if(this._events=this._events||{},t in this._events!=!1)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},i.mixin=function(t){for(var e=["bind","unbind","trigger"],r=0;r<e.length;r++)t.prototype[e[r]]=i.prototype[e[r]]},"undefined"!=typeof e&&"exports"in e&&(e.exports=i)},{}],2:[function(t,e,r){var i=function(t){function e(t,e,r,i,s){var n=s;return n|=t<<24,n|=e<<21,n|=r<<19,n|=i<<16}function r(t){for(var e=t.split("\n"),r=[],i={},n=[],o=[],a=0;a<e.length;a++){var h=e[a].trim(),u=h.indexOf(";");if(u!=-1&&(h=h.substring(0,u)),0!==h.length){var c=h.split(/[\s]+/);if(s.indexOf(c[0])==-1&&(n.push(c[0]),o.push(r.length),c.shift()),"DC"==c[0])o.pop(),o.push(parseInt(c[1]));else{if(3==c.length&&(","!=c[1][c[1].length-1]||(c[1]=c[1].substring(0,c[1].length-1))),3==c.length)if(u=c[2].indexOf("("),u!=-1){var f=c[2].indexOf(")",u);f==-1||(c.push(c[2].substring(u+1,f)),c[2]=c[2].substring(0,u))}else"="==c[2][0]?c.push("R0"):"@"==c[2][0]?"R"==c[2][1]?(c.push("R"+c[2][2]),c[2]="0"):c.push("R0"):"R"==c[2][0]?(c.push(c[2]),c[2]="=0"):c.push("R0");i[r.length]=a,r.push(c)}}}return{code:r,symbols:n,data:o,lineMap:i}}var i={NOP:0,STORE:1,LOAD:2,IN:3,OUT:4,ADD:17,SUB:18,MUL:19,DIV:20,MOD:21,AND:22,OR:23,XOR:24,SHL:25,SHR:26,NOT:27,SHRA:28,COMP:31,JUMP:32,JNEG:33,JZER:34,JPOS:35,JNNEG:36,JNZER:37,JNPOS:38,JLES:39,JEQU:40,JGRE:41,JNLES:42,JNEQU:43,JNGRE:44,CALL:49,EXIT:50,PUSH:51,POP:52,PUSHR:53,POPR:54,SVC:112},s=Object.keys(i),n={CRT:0},o={HALT:11},a={IMMEDIATE:0,DIRECT:1,INDIRECT:2},h=6;t.compile=function(t){function s(t){for(var e=0;e<f.symbols.length;e++)if(f.symbols[e]==t)return f.code.length+e}function u(t){return"SP"==t||2==t.length&&"R"==t[0]}function c(t){return"SP"==t?h:parseInt(t[1])}var f=r(t),l=[],g=!0,p=!1,m=void 0;try{for(var v,y=f.code[Symbol.iterator]();!(g=(v=y.next()).done);g=!0){var R=v.value;u(R[1])?R[1]=c(R[1]):R[1]=s(R[1]);var d=i[R[0]],E=R[1],P=0,S=a.DIRECT,b=0;if(R.length>2){if("="==R[2][0]){S=a.IMMEDIATE;var O=R[2].substring(1);if(/^[0-9]+$/i.test(O))b=parseInt(O);else switch(O){case"CRT":b=n.CRT;break;case"HALT":b=o.HALT}}else"@"==R[2][0]?(S=a.INDIRECT,b=parseInt(R[2].substring(1))):b=/^[a-z]+$/i.test(R[2])?s(R[2]):parseInt(R[2]);P=c(R[3])}d>=i.JUMP&&d<=i.JNGRE&&(b=E,E=0,S=0);var J=e(d,E,S,P,b);l.push(J)}}catch(t){p=!0,m=t}finally{try{!g&&y.return&&y.return()}finally{if(p)throw m}}return{lines:f.code,code:l,symbols:f.symbols,data:f.data,lineMap:f.lineMap}};return t}(i||{});"undefined"!=typeof e&&"exports"in e&&(e.exports=i)},{}],3:[function(t,e,r){var i=t("./ttk91js.compile.js"),s=t("./ttk91js.machine.js");e.exports={compile:i.compile,createMachine:function(t){return new s.Machine(t)}}},{"./ttk91js.compile.js":2,"./ttk91js.machine.js":4}],4:[function(t,e,r){var i=function(e){function r(t){return[(t&255<<24)>>24,(t&7<<21)>>21,(t&3<<19)>>19,(t&7<<16)>>16,65535&t]}function i(t){this.settings=t,this.memory=new Uint32Array(t.memory),this.stdout=function(t){},this.lastPosition=0,this.reset()}var s=t("microevent"),n={NOP:0,STORE:1,LOAD:2,IN:3,OUT:4,ADD:17,SUB:18,MUL:19,DIV:20,MOD:21,AND:22,OR:23,XOR:24,SHL:25,SHR:26,NOT:27,SHRA:28,COMP:31,JUMP:32,JNEG:33,JZER:34,JPOS:35,JNNEG:36,JNZER:37,JNPOS:38,JLES:39,JEQU:40,JGRE:41,JNLES:42,JNEQU:43,JNGRE:44,CALL:49,EXIT:50,PUSH:51,POP:52,PUSHR:53,POPR:54,SVC:112},o={CRT:0},a={HALT:11},h=4,u=2,c=1,f=6,l=7;return i.prototype={_getValue:function(t,e,r){var i=0;return i=0===e?r:this.reg[e]+r,t>0&&(i=this._getValue(--t,e,this.memory[r])),i},load:function(t){for(var e=0;e<t.code.length;e++)this.memory[e]=t.code[e];for(var r=0;r<t.symbols.length;r++)this.memory[e+r]=t.data[r];this.data=t},getRegister:function(){return{0:this.reg[0],1:this.reg[1],2:this.reg[2],3:this.reg[3],4:this.reg[4],5:this.reg[5],SP:this.reg[f],FP:this.reg[l],PC:this.reg.PC}},getMemory:function(){return this.memory},getRealLine:function(){return this.data.lineMap[this.lastPosition]},stop:function(){this.ok=!1},setStdout:function(t){this.stdout=t},reset:function(){this.ok=!0,this.SR=0,this.reg={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,FP:0,PC:0},this.memory.fill(0)},run:function(){for(var t=0;this.isRunning()&&t<100;)this.runWord(),t++},isRunning:function(){return this.ok&&this.reg.PC<this.memory.length},runWord:function(t){t=t||1;for(var e=0;e<t;e++)this._runWord()},_runWord:function(){var t=r(this.memory[this.reg.PC]),e=_slicedToArray(t,5),i=e[0],s=e[1],f=e[2],l=e[3],g=e[4],p=this._getValue(f,l,g);switch(this.lastPosition=this.reg.PC,this.reg.PC++,i){case n.STORE:var m=this.memory[g];this.memory[g]=this.reg[s],this.settings.triggerMemoryChange&&m!=this.memory[g]&&this.trigger("memory-change",g,m,this.memory[g]);break;case n.LOAD:this.reg[s]=p;break;case n.OUT:switch(g){case o.CRT:this.stdout(this.reg[s])}break;case n.ADD:this.reg[s]+=p;break;case n.SUB:this.reg[s]-=p;break;case n.DIV:this.reg[s]=Math.floor(this.reg[s]/p);break;case n.MUL:this.reg[s]*=p;break;case n.SVC:switch(g){case a.HALT:this.ok=!1}break;case n.COMP:this.SR=0,this.reg[s]==p&&(this.SR|=u),this.reg[s]>p&&(this.SR|=c),this.reg[s]<p&&(this.SR|=h);break;case n.JUMP:this.reg.PC=this.memory[g];break;case n.JNEG:break;case n.JZER:break;case n.JPOS:break;case n.JNNEG:break;case n.JNZER:break;case n.JNPOS:break;case n.JLES:break;case n.JEQU:this.SR&u&&(this.reg.PC=this.memory[g]);break;case n.JGRE:break;case n.JNLES:break;case n.JNEQU:this.SR&u||(this.reg.PC=this.memory[g]);break;case n.JNGRE:}}},s.mixin(i),e.Machine=i,e}(i||{});"undefined"!=typeof e&&"exports"in e&&(e.exports=i)},{microevent:1}]},{},[3]);